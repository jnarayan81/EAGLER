CXX=g++
SRC=../src

CXXFLAGS+=-std=c++11
CXXFLAGS+=-I../vendor/seqan/include
CXXFLAGS+=-I../lib
CXXFLAGS+=-W -Wall -Wno-long-long -pedantic -Wno-variadic-macros
LDFLAGS=

OBJ=bwa.o utility.o scaffolder.o

UNAME_S := $(shell uname -s)

ifeq ($(UNAME_S),Linux)
	LDFLAGS+=-lrt
endif
ifeq ($(UNAME_S),Darwin)
	# hack to avoid selecting old system g++
	CXX=g++-4.9
endif

default: all
all: $(OBJ) main

bwa.o: $(SRC)/bwa.cpp
	$(CXX) $(CXXFLAGS) -c -o bwa.o $(SRC)/bwa.cpp

utility.o: $(SRC)/utility.cpp
	$(CXX) $(CXXFLAGS) -c -o utility.o $(SRC)/utility.cpp

scaffolder.o: $(SRC)/scaffolder.cpp
	$(CXX) $(CXXFLAGS) -c -o scaffolder.o $(SRC)/scaffolder.cpp

main: main.o
	$(CXX) $(LDFLAGS) -o main main.o $(OBJ)

main.o: $(SRC)/main.cpp
	$(CXX) $(CXXFLAGS) -c -o main.o $(SRC)/main.cpp

clean:
	rm -f $(OBJ)
	rm -f main.o main

.PHONY: default all clean
